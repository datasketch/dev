<!DOCTYPE html>
<html>
	<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href='/css/tailwind-1.3.5.min.css'>
<link rel="stylesheet" href='/css/titi.css'>
<link rel="stylesheet" href='/css/extend.css'>
<link rel="stylesheet" href='/css/custom.css'>



  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-164320300-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







  
    
    
      
    
    
  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM&#43;Plex&#43;Sans:400,500">



  <title>How to make spirals with R and make indigenous communities count - Datasketch Dev</title>



	<body class="min-h-screen flex flex-col">
		




<header id="main-header" data-config="{&#34;behavior&#34;:&#34;sticky&#34;,&#34;bg_color&#34;:&#34;#fcfcfc&#34;,&#34;bg_color_class&#34;:&#34;bg-gray-800&#34;,&#34;logo&#34;:&#34;images/datasketch.svg&#34;,&#34;text_color&#34;:&#34;#222526&#34;,&#34;text_color_class&#34;:&#34;&#34;}" class="w-full h-16 px-4 z-10">
  <nav class="h-full flex flex-col items-center md:justify-between md:flex-row">
    
    <div class="w-full h-full flex justify-between items-center md:w-auto">
      <a href="/">
        <img class="max-w-xs" src="/images/datasketch.svg" alt="">
      </a>
      <div class="flex items-center space-x-4 md:hidden">
        
          <button id="sidebar-toggle" style="color: #222526;" class="">
            <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/></svg>
          </button>
        
        
            
  <a href="https://twitter.com/datasketch" target="_blank" rel="noopener noreferrer">
    <img src='/images/tw.svg' alt="">
  </a>


  <a href="mailto:info@datasketch.co">
    <img src='/images/mail.svg' alt="">
  </a>


  <a href="https://facebook.com/datasketch/" target="_blank" rel="noopener noreferrer">
    <img src='/images/fb.svg' alt="">
  </a>

        
      </div>
    </div>
    
    <div class="nav-links">
      
        
        
          <a href="/blog/" class='' title="Blog">Blog</a>
        
          <a href="/apps/" class='' title="Datasketch Apps">Datasketch Apps</a>
        
          <a href="/packages-and-libraries/" class='' title="Packages and libraries">Packages and libraries</a>
        
          <a href="/post/2020-07-07-what-are-we-doing/" class='' title="What are we doing">What are we doing</a>
        
      
      <div
        class="hidden items-center space-x-4 md:flex">
        
  <a href="https://twitter.com/datasketch" target="_blank" rel="noopener noreferrer">
    <img src='/images/tw.svg' alt="">
  </a>


  <a href="mailto:info@datasketch.co">
    <img src='/images/mail.svg' alt="">
  </a>


  <a href="https://facebook.com/datasketch/" target="_blank" rel="noopener noreferrer">
    <img src='/images/fb.svg' alt="">
  </a>

      </div>
    </div>
  </nav>
</header>

		<main id="main-content" class="flex-grow">
			
  <div class="overflow-x-hidden">
    
      <div class="w-full text-center mx-auto py-16 px-4 sm:w-5/6 md:w-3/4 lg:w-7/12 xl:w-2/5">
        <h1 class="text-5xl">How to make spirals with R and make indigenous communities count</h1>
        
      </div>
    
    
  </div>
  <div class="page-post-content px-4 w-full mx-auto leading-loose sm:w-5/6 md:w-3/4 md:text-lg lg:w-7/12 xl:w-1/2">
    <p>It all started a few months ago. We started collaborating with an organization doing indigenous journalism in Colombia. We wanted to find some balance between the numbers and the identity of the different indigenous communities we were working with.</p>
<p>Here is the result, in this post, we will tell you how we got there from a boring census spreadsheet to show numbers that did well in representing the communities.</p>
<p><img src="1-poblacion.gif" alt=""></p>
<p><em>Out of a thousand Colombians 44 belong to an indigenous community</em></p>
<p><a href="https://www.agendapropia.co/mujer-palabra-resistencia/">Check out the full investigation</a> where these visualizations are featured, available en Spanish, and the different languages of the three communities: Wayuu, Gunadule, and Tikuna.</p>
<p>We feel it is very important as a data team to support social organizations and journalists to show the realities of vulnerable groups. It usually happens that these groups make the headlines in rare occasions when very unlikely events happen, such as the coverage by <a href="https://www.economist.com/obituary/2020/05/28/antonio-bolivar-died-on-april-30th">The Economist</a> and the <a href="https://www.newyorker.com/news/daily-comment/the-death-of-antonio-bolivar-an-indigenous-elder-in-the-amazon-rainforest">New Yorker</a> of the death of Antonio Bolívar, the last member of a community in the Amazon who became famous for his role in the oscar-nominated movie The Embrace of The Serpent.</p>
<!-- raw HTML omitted -->
<p>In an effort to put a human face to the stories of indigenous women in Colombia who live at the border with countries like Venezuela, Brazil, Perú, and Panamá. We embarked with the help of the team at <a href="http://agendapropia.co">Agenda Propia</a> in a path to connect raw numbers and data buried in the statistical census with the faces, photographs, narrative stories, and visual elements of those communities in the Amazon, the Guajira desert and the Darien region.</p>
<blockquote>
<p>The visual elements we decided to use were those emerging from their ancestral fabrics and patterns.</p>
</blockquote>
<p><img src="4-wayuu.gif" alt="4-wayuu.gif"></p>
<p><em>380.460 are Wayuu in the Colombian side of them are women 197.140, their language: Wayuunaiki. There are 542.043 Wayuus at both sides of the Colombian-Venezuelan bolder</em></p>
<p>We decided to make a data visualization that portrayed indigenous patterns and their different proportions from different census numbers. We started looking at ways to arrange dots in patterns, aesthetically the circle provided a great arrangement, so <strong>we were left to find a way to pack circles that looked organic.</strong></p>
<p>We thought of arranging the dots in a spiral, here where the code starts. We didn&rsquo;t know there were <a href="https://en.wikipedia.org/wiki/List_of_spirals">so many possibilities for creating spirals</a>. Here are a few:</p>
<ul>
<li>Archimedean spiral</li>
<li>Circle involute</li>
<li>Atzema spiral</li>
<li>Logarithmic spiral</li>
<li>Vogel spiral</li>
</ul>
<p>The logarithmic spiral was out of question, as we wanted a spiral that looked dense and with somewhat constant density along a circle. Vogel spiral is not really a spiral, but more on that later. And the Atzema spiral for large <code>n</code> approximates the Archimedean spiral and starts with an asymptote that one can tweak.</p>
<p>The code of the spirals is posted here but can be found here: <a href="script.R">script.R</a></p>
<pre><code>archimedean_spiral &lt;- function(n, a = 0, b = 1, turns = 3){
  # b separation of turns
  t &lt;- seq(0, turns  * 2 *pi, length.out=n)
  x &lt;- (a + b*t) * cos(t)
  y &lt;- (a + b*t) * sin(t)
  d &lt;- tibble::tibble(x, y)
  d$n &lt;- 1:n
  d
}

circle_involute &lt;- function(n, a = 2){
  # https://mathworld.wolfram.com/CircleInvolute.html
  t &lt;- seq(0,5*pi, length.out=n)
  x &lt;- a * (cos(t) + t * sin(t))
  y &lt;- a * (sin(t) - t * cos(t))
  d &lt;- tibble::tibble(x, y)
  d$n &lt;- 1:n
  d
}

atzema_spiral &lt;- function(n, turns = 3){
  t &lt;- seq(0, turns * 2 *pi, length.out=n)
  x &lt;- sin(t)/t - 2 * cos(t) - t * sin(t)
  y &lt;- cos(t)/t - 2 * sin(t) + t * cos(t)
  d &lt;- tibble::tibble(x, y)
  d$n &lt;- 1:n
  d
}

vogel_spiral &lt;- function(n){
  t &lt;- 1:n
  r &lt;- sqrt(t)
  golden_angle &lt;- pi * (3 - sqrt(5))
  theta &lt;- t * golden_angle
  x &lt;- r * cos(theta)
  y &lt;- r * sin(theta)
  d &lt;- tibble::tibble(x, y)
  d$n &lt;- 1:n
  d
}

</code></pre><p>Here you see samples of the spirals above.</p>
<p><img src="spirals.png" alt=""></p>
<p>We need spirals that work fine with a different number of points, in the tens, or even in the thousands of points. We tried to use the convolute circle but with the Archimedean spiral, one can have a bit more control over the number of turns and their separation.</p>
<p>Let&rsquo;s see how the Archimedean spiral looks for different numbers of points. Note that when we see the spirals not as paths but as points we get a different picture. For our specific use case we needed points that filled a circle in a uniform way, independent on the number of points we use, for this we went ahead and made more tweaks to our function such that we could approximate the arc in the Archimedean spiral so we could keep it constant.</p>
<p><img src="archimedean-points.png" alt=""></p>
<p>We were not happy with the arrangements of points for different <code>n</code>. The end of the spiral always looks as if something is missing, it doesn&rsquo;t give the impression that the dots fill a circle in a smooth way.</p>
<p>That&rsquo;s when we turned to the <a href="https://www.codeproject.com/Articles/1221341/The-Vogel-Spiral-Phenomenon">Vogel spiral</a>. The Vogel spiral takes into account the <a href="https://en.wikipedia.org/wiki/Golden_angle">Golden Angle</a>, which is like the golden ratio but along two arcs in a circle, and starts adding points every <code>137.5077...</code> degrees or <code>pi ( 3 - sqrt(5))</code> radians and scaling the radius by <code>sqrt(n)</code></p>
<p><img src="Golden_Angle.png" alt=""></p>
<p>The pattern looks very organic, and works beautifully with any given <code>n</code>, just make sure you adjust the size of the points that work for you for different values of <code>n</code>.</p>
<p><img src="vogel.png" alt=""></p>
<p>Enjoy some more patterns from indigenous communities.</p>
<p><img src="6-gunadule.gif" alt=""></p>
<p><em>This is the Gunadule pattern, an indigenous community in the border of Panama and Colombia, there are 2610 members of this community</em></p>
<p><img src="8-tikuna.gif" alt=""></p>
<p><em>There are 13.842 Tikunas en Colombia, they live in the Amazon</em></p>
<p>If you are curious about the animations we simply set up the patterns as polygons and used <a href="https://github.com/thomasp85/transformr">{transformr}</a></p>

  </div>

		</main>
		
<footer
  style="background-color: #222526; color: #ffffff;"
  class='bg-gray-900 text-white'
>
  <div class="flex flex-wrap items-center px-16 py-12">
    <div class="w-full md:w-1/3 flex flex-col items-center">
      <img class="sm:w-1/2" src='/images/datasketch_v.svg' alt="">
    </div>
    <div class="w-full md:w-1/3 flex flex-col items-center  mt-10 md:mt-0">
      <p class="uppercase text-xl font-bold">Share</p>
      <div class="flex items-center mt-4">
        
          <a class="mr-4" href="https://twitter.com/datasketch" target="_blank" rel="noopener noreferrer">
            <img src='/images/tw.svg' alt="">
          </a>
        
        
          <a class="mr-4" href="mailto:info@datasketch.co">
            <img src='/images/mail.svg' alt="">
          </a>
        
        
          <a class="mr-0" href="https://facebook.com/datasketch/" target="_blank" rel="noopener noreferrer">
            <img src='/images/fb.svg' alt="">
          </a>
        
      </div>
    </div>
    <div class="w-full md:w-1/3 flex flex-col items-center mt-10 md:mt-0">
      <div class="flex items-center">
        <img class="mr-4" src='/images/cc.svg'>
        <img class="mr-4" src='/images/by.svg'>
        <img class="mr-0" src='/images/sa.svg'>
      </div>
      <p class="mt-4 w-64 text-sm">If you use or adapt the contents of this site please include a reference. All contents, unless otherwise stated is licenced with <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA </a></p>
    </div>
  </div>
</footer>

		<script src='/js/header.js'></script>
	</body>

</html>